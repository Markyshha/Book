<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìö –ß–∏—Ç–∞–ª–∫–∞ Lumia</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial;
            padding: 10px;
            background: #f0f0f0;
        }
        h1 {
            color: #0066cc;
            text-align: center;
        }
        .tab {
            display: none;
        }
        .active {
            display: block;
        }
        button {
            background: #0066cc;
            color: white;
            border: none;
            padding: 10px;
            margin: 5px 0;
            width: 100%;
            font-size: 16px;
        }
        textarea {
            width: 100%;
            height: 200px;
            margin: 10px 0;
            padding: 8px;
            font-size: 16px;
        }
        input {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            font-size: 16px;
        }
        .book {
            background: white;
            padding: 10px;
            margin: 10px 0;
            border-left: 3px solid #0066cc;
        }
    </style>
</head>
<body>
    <h1>üìö –ß–∏—Ç–∞–ª–∫–∞ Lumia</h1>

    <button onclick="showTab('github')">–ö–Ω–∏–≥–∏ —Å GitHub</button>
    <button onclick="showTab('local')">–õ–æ–∫–∞–ª—å–Ω—ã–µ –∫–Ω–∏–≥–∏</button>
    <button onclick="showTab('editor')">–†–µ–¥–∞–∫—Ç–æ—Ä</button>

    <!-- –í–∫–ª–∞–¥–∫–∞ GitHub -->
    <div id="github" class="tab active">
        <h2>–ö–Ω–∏–≥–∏ —Å GitHub:</h2>
        <div id="github-books">
            <div class="book">
                <h3>–ü—Ä–∏–º–µ—Ä –∫–Ω–∏–≥–∏</h3>
                <p>https://raw.githubusercontent.com/–í–ê–®_–õ–û–ì–ò–ù/–í–ê–®_–†–ï–ü–û–ó–ò–¢–û–†–ò–ô/main/books/–∫–Ω–∏–≥–∞1.txt</p>
                <button onclick="loadGitHubBook(this.previousElementSibling.textContent)">–ß–∏—Ç–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∫–Ω–∏–≥ -->
    <div id="local" class="tab">
        <h2>–í–∞—à–∏ –∫–Ω–∏–≥–∏:</h2>
        <div id="local-books"></div>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ -->
    <div id="editor" class="tab">
        <input type="text" id="book-title" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏">
        <textarea id="book-content" placeholder="–¢–µ–∫—Å—Ç –∫–Ω–∏–≥–∏..."></textarea>
        <button onclick="saveBook()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>

    <!-- –û–±–ª–∞—Å—Ç—å —á—Ç–µ–Ω–∏—è -->
    <div id="reader" style="display:none; margin-top:20px; background:white; padding:10px;">
        <button onclick="hideReader()">–ù–∞–∑–∞–¥</button>
        <div id="book-content"></div>
    </div>

    <script>
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function showTab(tabId) {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(tabId).classList.add('active');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–Ω–∏–≥ —Å GitHub
        function loadGitHubBook(url) {
            showReader();
            document.getElementById('book-content').textContent = "–ó–∞–≥—Ä—É–∑–∫–∞...";
            
            // –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å –±–µ–∑ fetch –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "https://cors-anywhere.herokuapp.com/" + url, true);
            xhr.onload = function() {
                if (xhr.status === 200) {
                    document.getElementById('book-content').textContent = xhr.responseText;
                } else {
                    document.getElementById('book-content').textContent = "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏";
                }
            };
            xhr.send();
        }

        // –õ–æ–∫–∞–ª—å–Ω—ã–µ –∫–Ω–∏–≥–∏
        function loadLocalBooks() {
            var books = JSON.parse(localStorage.getItem('localBooks') || [];
            var container = document.getElementById('local-books');
            container.innerHTML = '';
            
            books.forEach(function(book, index) {
                var div = document.createElement('div');
                div.className = 'book';
                div.innerHTML = `
                    <h3>${book.title}</h3>
                    <button onclick="readLocalBook(${index})">–ß–∏—Ç–∞—Ç—å</button>
                    <button onclick="editLocalBook(${index})">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                    <button onclick="deleteLocalBook(${index})">–£–¥–∞–ª–∏—Ç—å</button>
                `;
                container.appendChild(div);
            });
        }

        function readLocalBook(index) {
            var books = JSON.parse(localStorage.getItem('localBooks'));
            showReader();
            document.getElementById('book-content').textContent = books[index].content;
        }

        function editLocalBook(index) {
            var books = JSON.parse(localStorage.getItem('localBooks'));
            document.getElementById('book-title').value = books[index].title;
            document.getElementById('book-content').value = books[index].content;
            window.editingIndex = index;
            showTab('editor');
        }

        function deleteLocalBook(index) {
            var books = JSON.parse(localStorage.getItem('localBooks'));
            books.splice(index, 1);
            localStorage.setItem('localBooks', JSON.stringify(books));
            loadLocalBooks();
        }

        // –†–µ–¥–∞–∫—Ç–æ—Ä
        function saveBook() {
            var title = document.getElementById('book-title').value;
            var content = document.getElementById('book-content').value;
            
            if (!title || !content) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!');
                return;
            }
            
            var books = JSON.parse(localStorage.getItem('localBooks')) || [];
            
            if (window.editingIndex !== undefined) {
                books[window.editingIndex] = {title: title, content: content};
                delete window.editingIndex;
            } else {
                books.push({title: title, content: content});
            }
            
            localStorage.setItem('localBooks', JSON.stringify(books));
            document.getElementById('book-title').value = '';
            document.getElementById('book-content').value = '';
            loadLocalBooks();
            showTab('local');
        }

        // –ß–∏—Ç–∞–ª–∫–∞
        function showReader() {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.style.display = 'none';
            });
            document.getElementById('reader').style.display = 'block';
        }

        function hideReader() {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.style.display = 'block';
            });
            document.getElementById('reader').style.display = 'none';
            showTab('local');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        loadLocalBooks();
    </script>
</body>
</html>
